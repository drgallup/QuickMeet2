<!DOCTYPE html>
<!-- -->
<html ng-app="MyApp">
<header>
  <link rel="stylesheet" href="css/menu.css">
  <div class="container">
          <ul class="navigation">
              <li class="navigation-items"> <a href="http://127.0.0.1:54042/public/index.html">Home</a> </li>
              <li class="navigation-items"> <a href="http://127.0.0.1:54042/public/help.html">Help</a> </li>
          </ul>
  </div>
</header>

    <h1>QuickMeet</h1>
  
  <script src = "js/redir.js"></script>

  <link rel="stylesheet" href="css/calendar.css">
      <!-- Angular Material style sheet -->
  <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/angular_material/1.1.0/angular-material.min.css">
  
  <!-- Load login on init -->
  <div data-ng-controller="PopCtrl" data-ng-init="showAlert($event)"></div>
  
  <section layout="row" flex-offset="5">
  <body id="popupContainer" onload="displayGroups()">
    <!-- Lists days over grid-->
    <div id = "cal">
    <table class="header">
      <tr>
        <td></td>
        <td>Sunday</td>
        <td>Monday</td>
        <td>Tuesday</td>
        <td>Wednesday</td>
        <td>Thursday</td>
        <td>Friday</td>
        <td>Saturday</td>
      </tr>
    </table>


    <canvas id="myCanvas" width="800" height="400">
    Your browser does not support the HTML5 canvas tag.
    </canvas>
    </div>
    <md-sidenav
        class="md-sidenav-left"
        md-component-id="left"
        md-is-locked-open="$mdMedia('gt-md')"
        md-whiteframe="4" flex-offset="5">

      <md-toolbar class="md-theme-indigo">
        <h1 class="md-toolbar-tools">Groups</h1>
      </md-toolbar>
      <md-content layout-padding ng-controller="UserCtrl">
      </md-content>


      <h2 ng-controller="ListGroups">
        <div ng-repeat="x in listOfGroups">
          {{x}}
        </div>
      </h2>
    </md-sidenav>
    </section>
    
    <form>
      <md-button class="md-primary md-raised" onclick = "userRedirect()" ng-hide=true>
        Go to user page
      </md-button>

      <md-button ng-controller="PopCtrl" class="md-primary md-raised" ng-click="showGroup($event)">
        Create Group
      </md-button>
          
      <md-button class="md-primary md-raised" onclick = "genPDF()">
        Generate PDF
      </md-button>
      
      <!-- login alert -->
      <md-button ng-controller="PopCtrl" class="md-primary md-raised" ng-click="showAlert($event)" ng-hide=false  >
        Login
      </md-button>
      
        <!-- delete / no delete switch -->
        <div style="margin: auto">
            <div div layout="row" layout-align="center center"  style="min-height: 10px" ng-controller="AppCtrl" ng-cloak="">
                <md-switch ng-model="data.cb1" aria-label="Switch 1">
                    Delete Mode: {{ data.cb1 }}
                </md-switch>
            </div>
        </div>
        
    </form>  
  </body>
    
      <!-- Angular Material requires Angular.js Libraries -->
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.5/angular.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.5/angular-animate.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.5/angular-aria.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.5/angular-messages.min.js"></script>

  <!-- Angular Material Library -->
  <script src="https://ajax.googleapis.com/ajax/libs/angular_material/1.1.0/angular-material.min.js"></script>
  
  <!-- JQuery, jsPDF and html2canvas Libraries -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.2/jspdf.min.js"></script>
  <script src="js/html2canvas.js"></script>

  <!-- Add our Source Files here -->
  <script src="js/angularController.js"></script>

    <!-- Script sources: add yours here -->
    <script src ="js/db.js"></script>
    <script src ="js/groupDB.js"></script>
    <script src ="js/pdfGenerator.js"></script>

    <script src ="js/CalendarGenerator.js"></script>
    
    <script src = "js/CoordinateTracker.js"></script>


    <script src ="js/BoxGenerator.js"></script>
    
    <script src ="js/undo.js"></script>

    
    <!-- <script src ="js/angular.js"></script> -->
    
    <script src ="js/coordinateHelper.js"></script>
    
    <script type="text/ng-template" id="dialog1.login.html">
      <md-dialog aria-label="Login Page">
        <form ng-cloak>
          <md-toolbar>
            <div class="md-toolbar-tools">
              <h2>Login Page</h2>
              <span flex></span>
              <md-button class="md-icon-button" ng-click="cancel()">
                <md-icon md-svg-src="img/icons/ic_close_24px.svg" aria-label="Close dialog"></md-icon>
              </md-button>
            </div>
          </md-toolbar>

          <md-dialog-content>
            <div class="md-dialog-content">
              <h2>Welcome to QuickMeet</h2>
              <p>
                Enter your username. If you don't have one, click new user.
              </p>
              
              <md-input-container>
                <font size="4">Username:</font>
                <input aria-label="username" id= "name" type="text" name="username" value="" md-autofocus>
              </md-input-container>
              
              <md-input-container ng-hide=true>
                <font size="4">Name:</font>
                <input aria-label="name" type="text" value="">
              </md-input-container>
              
              
            </div>
          </md-dialog-content>

          <md-dialog-actions layout="row">
            <md-button ng-click="cancel()">
              Cancel
            </md-button>
            <span flex></span>
            <md-button ng-click="answer('New User')" onclick="newUserCreation()">
             New User
            </md-button>
            <md-button ng-click="answer('Returning User')" onclick="returningUserCreation()">
              Returning User
            </md-button>
          </md-dialog-actions>
        </form>
        
      </md-dialog>
      
    <script  src ="js/db.js"></script>
    </script>
    
    <!-- Group Dialog popup HTML -->
    <script type="text/ng-template" id="dialog1.group.html">
      <md-dialog aria-label="Name Your Group">
        <form ng-cloak>
          <md-toolbar>
            <div class="md-toolbar-tools">
              <h2>Group Creation</h2>
              <span flex></span>
              <md-button class="md-icon-button" ng-click="cancel()">
                <md-icon md-svg-src="img/icons/ic_close_24px.svg" aria-label="Close dialog"></md-icon>
              </md-button>
            </div>
          </md-toolbar>

          <md-dialog-content>
            <div class="md-dialog-content">
              <h2>Create a Group</h2>
              <p>
                Enter the name of the group.
              </p>
              
              <md-input-container>
                <font size="4">Group Name:</font>
                <input aria-label="group name" id= "name" type="text" name="username" value="">
              </md-input-container>
              
              <md-input-container ng-hide=true>
                <font size="4">Name:</font>
                <input aria-label="name" type="text" value="">
              </md-input-container>
              
              
            </div>
          </md-dialog-content>

          <md-dialog-actions layout="row">
            <md-button ng-click="cancel()">
              Cancel
            </md-button>
            <span flex></span>
            <md-button ng-click="answer('Confirm')" onclick="newGroupCreation()">
             Create
            </md-button>
          </md-dialog-actions>
        </form>
        
      </md-dialog>
      
    <script  src ="js/db.js"></script>
    </script>

<br><br><br>
    
<script src="https://www.gstatic.com/firebasejs/3.9.0/firebase.js"></script>
<script>
  // Initialize Firebase
  // TODO: Replace with your project's customized code snippet
  var loadedDB;
  var groupLoadedDB;
  var config = {
    apiKey: "AIzaSyBetNrKXVXpI6OrSjOpwVIm_HQSZ0p64tw",
    authDomain: "quickmeet2-c69c9.firebaseapp.com",
    databaseURL: "https://quickmeet2-c69c9.firebaseio.com",
    storageBucket: "bkt1.appspot.com",
    messagingSenderId: "admin",
  };
  firebase.initializeApp(config);
  console.log("success");
    // Get a reference to the database service
    var database = firebase.database();

    function writeUserData() {
        var link = window.location.href.split("username=");
        var username = link[1];
        firebase.database().ref('user/'+username+'/').set(dataJSON);
        console.log("wrote user");
    }

    function readUserData(){
        
        var username = document.getElementById("name").value;
        GLOBALUserName = username;
        return firebase.database().ref('user/'+username+'/').once('value').then(function(snapshot) {
        loadedDB = snapshot.val();
        console.log(loadedDB);
        });
        console.log("read user");
    }
    function writeGroupData() {
        var link = window.location.href.split("groupName=");
        var groupname = link[1];
        firebase.database().ref('groups/'+groupname+'/').set(groupDataJSON);
        console.log("wrote groups");
    }
    function readGroupData(){
        
        var link = window.location.href.split("groupName=");
        var groupname = link[1];
        
        return firebase.database().ref('groups/'+groupname+'/').once('value').then(function(snapshot) {
        groupLoadedDB = snapshot.val();
        console.log(groupLoadedDB);
        });
        console.log("read user");
    }
</script>
</html>

